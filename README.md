# 交通音频异常事件检测系统

这是一个基于深度学习的交通音频异常事件检测系统，可以自动识别交通环境中的异常声音，如交通事故、鸣笛、紧急刹车等。

## 项目结构

```
├── main.py                # 主入口脚本
├── requirements.txt       # 项目依赖
├── configs/               # 配置文件目录
│   └── config.yaml        # 模型配置文件
├── src/                   # 源代码目录
│   ├── trainer.py         # 模型训练脚本
│   └── inference.py       # 模型推理脚本
├── models/                # 模型定义目录
│   └── anomaly_detection_model.py  # 异常检测模型
├── utils/                 # 工具函数目录
│   └── data_processor.py  # 数据处理模块
├── data/                  # 数据存储目录
└── README.md              # 项目说明文档
```

## 系统组件

### 1. 数据预处理与特征提取
- **音频输入**：接受来自交通监控摄像头麦克风的单通道音频数据
- **特征提取**：从原始音频中提取梅尔频谱图（Mel-spectrogram）作为输入特征
- **数据增强**：支持添加背景噪声、时间偏移、速度调整、音量调整等数据增强技术

### 2. 模型架构
- **卷积神经网络（CNN）**：用于提取音频特征中的局部时频模式
- **循环神经网络（RNN）**：使用LSTM捕捉音频序列中的时间依赖性
- **自注意力机制**：增强模型对重要时刻的关注

### 3. 异常检测机制
- **重构误差**：通过比较输入与模型重构输出之间的误差来判断异常
- **阈值设定**：当重构误差超过设定阈值时，判定为异常事件

### 4. 训练与评估
- **训练策略**：使用正常音频数据进行训练，采用无监督学习方法
- **评估指标**：支持准确率、召回率、F1分数等评估指标

## 环境配置

### 安装依赖

```bash
pip install -r requirements.txt
```

### 数据集准备

建议使用BCNDataset或其他包含交通环境音频的数据集。将数据集放置在`data/`目录下。

### 配置文件设置

可以通过修改`configs/config.yaml`文件来自定义模型参数、训练参数和数据路径等配置。

## 使用指南

### 训练模型

```bash
python main.py train --config configs/config.yaml
```

### 异常检测推理

处理单个音频文件：

```bash
python main.py infer --config configs/config.yaml --input /path/to/audio.wav --plot
```

处理目录中的所有音频文件：

```bash
python main.py infer --config configs/config.yaml --input /path/to/audio/directory --plot
```

### 命令行参数说明

- `--config`：配置文件路径（默认：configs/config.yaml）
- `--model`：训练好的模型路径（默认：使用配置文件中指定的路径）
- `--input`：输入音频文件或目录路径
- `--threshold`：异常检测阈值（默认：使用配置文件中指定的阈值）
- `--plot`：生成可视化结果（默认：不生成）

## 模型评估

在实际应用中，您可以使用带有真实标签的测试数据集来评估模型性能，系统支持计算准确率、精确率、召回率和F1分数等指标。

## 注意事项

1. 确保您的环境中安装了所有必要的依赖包
2. 训练模型需要足够的计算资源，建议使用GPU加速
3. 为了获得最佳的异常检测效果，可能需要根据您的具体数据集调整阈值
4. 数据增强可以提高模型的鲁棒性，但也可能增加训练时间

## 扩展建议

1. 可以尝试不同的模型架构，如Transformer等
2. 考虑使用更多类型的数据增强技术
3. 探索半监督学习或迁移学习方法来提高检测性能
4. 可以开发实时检测系统，与交通监控系统集成